<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="description" content="Crede Reservation">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Crede reservation</title>
		<script type="text/javascript" src="./lib/jquery/jquery.min.js"></script>
		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="./lib/bootstrap/css/bootstrap.min.css">

		<!-- Optional theme -->
		<link rel="stylesheet" href="./lib/bootstrap/css/bootstrap-theme.min.css">

		<!-- Latest compiled and minified JavaScript -->
		<script type="text/javascript" src="./lib/bootstrap/js/bootstrap.min.js"></script>
    </head>
    <body>
    	<div class="container">
    		<br>
    	</div>
  <script type="text/javascript">
function querySync(query, callback) {
	$.post(
  		query.url,
  		query.data,
  		function(res){
  			$('.container').append(
`<div class="panel panel-default">
  <div class="panel-body">
  	<code>URL = ${query.url}</code><br>
  	<code>DATA = ${JSON.stringify(query.data)}</code><br><br>
  	<pre>${res}</pre>
  </div>
</div>`
			);
			callback();
  	});
}

function queryAsync(param){
	obj = {
		then: function (param2) {
			if(param2){
				querySync(param2, this.then);
			}
			return this;
		}
	}
	querySync(param, obj.then);
	return obj;
}

function listAll(){
	$('.container').append('<h4>List All</h4>');

	queryAsync({
		url: 'api/login',
		data: { name: 'admin', pass: 'admin' }
	})
	.then({
		url: 'api/places',
		data: {
			action: 'listAll'
		}
	})
	.then({
		url: 'api/users',
		data: {
			action: 'listAll'
		}
	})
	.then({
		url: 'api/permissions',
		data: {
			action: 'listAll'
		}
	})

}

function listItem(){
	$('.container').append('<h4>List Item</h4>');

	queryAsync({
		url: 'api/login',
		data: { name: 'admin', pass: 'admin' }
	})
	.then({
		url: 'api/places',
		data: {
			action: 'listItem',
			obj: {
				id: 1
			}
		}
	})
	.then({
		url: 'api/users',
		data: {
			action: 'listItem',
			obj: {
				name: 'arthur'
			}
		}
	})
	.then({
		url: 'api/permissions',
		data: {
			action: 'listItem',
			obj: {
				username: 'admin',
				module: 'places'
			}
		}
	})

}

listItem();

// //Categories
// queryAsync({
// 	url: "api/categories",
// 	data: {
// 		action: 'insertItem',
// 		obj: {
// 			name: 'Cozinha'
// 		}
// 	}
// })
// // .then({
// // 	url: 'api/logout'
// // })
// .then({
// 	url: "api/categories",
// 	data: { action: 'listAll' }
// })
// .then({
// 	url: 'api/categories',
// 	data : { action: 'removeItensFree' }
// })
// .then({
// 	url: 'api/categories',
// 	data: { action: 'listPermissions' }
// });


//Permissions
// queryAsync({
// 	url: "api/permissions",
// 	data: {
// 		action: 'filterByColumns',
// 		obj: {module: 'categories', u: false}
// 	}
// }).then({
// 	url: "api/permissions",
// 	data: {
// 		action: 'filterByColumns',
// 		obj: {module: 'categories'}
// 	}
// })
// .then({
// 	url: "api/permissions",
// 	data: {
// 		action: 'filterByColumns',
// 		obj: {}
// 	}
// })
// .then({
// 	url: "api/permissions",
// 	data: {
// 		action: 'filterByColumns'
// 	}
// });

//Equipments
// queryAsync({
// 	url: "api/equipments",
// 	data: { action: 'listAll' }
// });

// .then({
// 	url: "api/permissions",
// 	data: {
// 		action: 'filterByColumns',
// 		obj: {module: 'categories'}
// 	}
// })
// .then({
// 	url: "api/permissions",
// 	data: {
// 		action: 'filterByColumns',
// 		obj: {}
// 	}
// })
// .then({
// 	url: "api/permissions",
// 	data: {
// 		action: 'filterByColumns'
// 	}
// });

  </script>
    </body>
</html>